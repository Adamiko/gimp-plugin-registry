============================ Separate+ Readme =========================

・概要
・動作要件
・用意しておくもの
・準備
・使い方
・デバイスリンクプロファイルを使った色分解
・ダイアログの説明
・環境設定との連動
・サンプルスクリプト
・TIFFインポートプラグイン
・ビルドする際のヒント
・ライセンス


----- 概要
Separate+は、GIMPのカラーマネジメント関連機能を補完し、オープンソースソ
ースソフトウェアを活用した出版（Web、印刷、その他）活動を支援することを
主な目的としたプロジェクト、およびプラグインパッケージの名称です。
本パッケージには、以下の3つのプラグインが収録されています。

separate
  RGB→CMYK変換・書き出し・ソフトプルーフプラグインで、Alastair M. 
  Robinson氏のSeparateプラグインを修正・改良したものです。

icc_colorspace
  RGB→RGB変換・プロファイル管理プラグインです。
  機能説明などは別ファイルに記載されています。

separate_import（付録）
  separateプラグインで書き出したCMYK TIFFファイルを取り込む（インポート
  する）プラグインです。他のアプリケーションで作成されたTIFFファイルにも
  使えますが動作保証はありません。


----- 動作要件
このプラグインを動作させるには、LittleCMSの1.15以降が必要です。
添付のWindowsバイナリはPentium IIIまたは互換CPU向けにビルドされています。
動作確認は、Windows版 GIMPのバージョン2.6.8で行いました。


----- 用意しておくもの
・ICCベースのカラーマネジメントに関する基本的な知識

・The GIMP（バージョン2.4以降）

・本パッケージ収録のプラグイン（GIMP 2.4以降用のWindowsバイナリは同梱）

・ICCプロファイル
  sRGBのプロファイルは同梱。Adobe RGBやJapan Color 2001 Coatedといった
  定番プロファイルは、Adobeのサイトよりダウンロードできます。

(Mac)
 http://www.adobe.com/support/downloads/iccprofiles/iccprofiles_mac.html
(Win/Linux)
 http://www.adobe.com/support/downloads/iccprofiles/iccprofiles_win.html


----- 準備
                              （Windows）

"bin\win32"フォルダにある実行ファイルをGIMPのプラグインフォルダにコピー
（または移動）します。プラグインフォルダの場所はGIMPの環境設定から確認で
きます（複数ある場合はいずれか一か所にコピーすれば結構です）。

ダイアログなどの表示を日本語にするには、"po"フォルダにあるファイル
"ja.gmo"を、GIMPのインストールフォルダから"share\locale\ja\LC_MESSAGES"
に入り、そこへ"gimp20-separate.mo"に名称変更しコピーしてください。

「用意しておくもの」で紹介したICCプロファイルについては、ダウンロードし
てきたZIPファイルを解凍し、出てきたファイル（拡張子.iccのもの）を所定の
場所a.またはb.のいずれかに移動させます。

a.適当なフォルダのウインドウを開いて、アドレス欄に"%COMMONPROGRAMFILES%\
  Adobe\Color\Profiles\Recommended"と入力しEnterキーを押します。該当する
  フォルダに移動できる場合はそのフォルダにICCプロファイルを入れます。
  既に同名のファイルが存在する場合は上書きする必要はありませんし、他の場
  所にコピーする必要もありません。

b.a.のフォルダが見つからない場合は、プロファイルのアイコンを選択し、右ク
  リックするとメニューに「プロファイルのインストール」という項目がありま
  すので、それをクリックしてください。

                              （Mac OS X）

MacPortsを使用してGIMPをビルド・インストールします。ターミナルを起動し、
Separate+のZIPファイルを解凍してできたフォルダに入り、以下のコマンドを実
行します。

 make -f Makefile.macosx
 sudo make -f Makefile.macosx install

※GIMP.appで使用する場合は、上記操作で作成されたseparate、separate_import、
icc_colorspaceの3つをプラグインフォルダにコピーしてください。フォルダの
場所は環境設定から確認できます。

「用意しておくもの」で紹介したICCプロファイルについては、ダウンロードし
てきたZIPファイルを解凍し、出てきたファイル（拡張子.iccのもの）を所定の
場所に移動させます。Mac OS Xでは、以下のうちいずれかのフォルダになります。

a. /Library/Application Support/Adobe/Color/Profiles/Recommended

b. /Library/ColorSync/Profiles

c. ホームフォルダ/Library/ColorSync/Profiles

                             （Linuxなど）

まず、GIMPの開発用パッケージがインストールされているか確認してください
（Ubuntuだと"libgimp2.0-dev"という名称です）。他に、Little CMS（lcms）、
libtiff、libjpegの開発用パッケージも必要ですので、合わせて確認しておいて
ください。

次に、必要に応じてエディタでMakefileを修正します。通常はPREFIXやINSTALLDIR
のあたりを自分の環境に合わせて変更することになるでしょう。

ターミナルウインドウを開き、Separate+のZIPファイルを解凍してできたフォル
ダに入り、以下のコマンドを実行します。

 make
 sudo make install

※sudoが使えない場合は、suで管理者権限を得てからmake installしてください。

「用意しておくもの」で紹介したICCプロファイルについては、ダウンロードし
てきたZIPファイルを解凍し、出てきたファイル（拡張子.iccのもの）を所定の
場所に移動させます。Linuxでは、以下のうちいずれかのフォルダになります。

a. /usr/share/color/icc

b. ~/.color/icc


----- 使い方
まず分解したいレイヤーをアクティブにします。特定のレイヤーだけ分解すると
いうことはあまりないと思いますので、通常は画像を統合することになるでしょ
う。

次に画像ウインドウのメニューより、画像->Separate->色分解を選択します。

「ソースカラースペース」には画像のプロファイルを指定（埋め込みプロファイ
ルがある場合は「埋め込みプロファイルを優先」にチェックを入れておけば結構
です）し、「変換先カラースペース」には印刷条件に合ったCMYK出力プロファイ
ルを指定してください。大抵はJapan Color 2001 Coatedで良いのですが、不明
な点があれば印刷業者に問い合わせてください。

レンダリングインテントは「知覚的」または「相対的な色域を維持」のいずれか
を選択します（どちらがいいかは分解結果を見て判断してください）。また、
「黒点の補正を使用」はチェックを入れておいた方が良いでしょう。

「CMYK擬似コンポジットを作成」は、分解後に微調整などを行うつもりであるな
らチェックを入れてください。

以上の指定を済ませ、OKをクリックすると4枚のレイヤー（他に背景レイヤーが
付く場合もあります）で構成される新規画像が作成されます。

それぞれのレイヤーがCMYKの各色に対応していますので、必要に応じて修正やト
ーンカーブ、レベル補正などを行ってもかまいません。ただし、レイヤー名は変
更しないでください。また、レイヤーやレイヤーマスクを追加・削除するのはお
勧めできません。修正結果を残しておきたい場合は、XCF形式で保存しておきま
す（PSD形式での保存はどのプロファイルを使って分解したか、の情報が失われ
ます）。

分解結果のカラーを画面で確認するには、分解画像のウインドウのメニューより、
画像->Separate->色校正を選択します。

「モニタのカラースペース」にはお使いのモニタのプロファイルを指定します。
プロファイルを確認したい場合は、画像ウインドウのメニューより、表示->ディ
スプレイフィルタ...を選択し、ダイアログが開いたら「色管理」フィルタをク
リックしてください。するとダイアログの下半分にモニタプロファイルの名称が
表示されます（なしになっている環境ではカラーの確認はできません）。

「分解画像のカラースペース」は分解のときに変換先カラースペースとして指定
したプロファイルを選択します。通常は分解に使用されたプロファイルの情報が
（分解結果の画像に）記録されていますので、「分解時のプロファイルを優先」
にチェックを入れておけばよいでしょう。

「モード」については、どれが最適というのは難しいのですが、Photoshopでは
デフォルトで「通常」を選んだときと同様の表示をするので、それに慣れている
方は「通常」を選択してください。

以上の指定を済ませ、OKをクリックすると確認用の画像が作成されます。環境設
定のカラーマネジメント->操作モードが「印刷シミュレーション」になっている
と適切なカラーで確認できないので注意してください。確認が済んだらウインド
ウを閉じて構いません。

最後に、分解結果をファイルに書き出しましょう。分解画像のウインドウのメニ
ューより、画像->Separate->書き出し...を選択します。
ファイル名を入力し、保存ボタンをクリックすれば完了です。このとき、プロフ
ァイルの埋め込みやクリッピングパスの選択を行うことができます。
※印刷業者に入稿する画像には、プロファイルを埋め込まないのが一般的です


----- デバイスリンクプロファイルを使った色分解
色分解ダイアログで、「デバイスリンクプロファイルを使用」にチェックを入れ
ます。ソースカラースペースのところがデバイスリンクプロファイルに変わるの
で、RGB→CMYKのデバイスリンクプロファイルを指定します。変換先の方は分解
後に添付するプロファイルを選択してください（どのプロファイルを選択しても
分解処理には影響しません）。必要がなければ、なしのままでも結構です。

ノンインタラクティブで実行する場合は、4番目の引数（input-profile）にデバ
イスリンクプロファイルを指定します。5番目の引数（output-profile）は空文
字列にするか、分解後に添付するプロファイルを指定してください（空文字列の
場合はプロファイルが添付されません）。


----- ダイアログの説明
■色分解ダイアログ
  ソースカラースペース
    元画像のカラースペースを表すICCプロファイルを選択します。変換の際に、
    元画像がどんなカラーをしているのかをコンピュータに把握させるために必
    要です。埋め込みプロファイルがある場合はチェックボックスをオンにして
    ください。

  変換先カラースペース
    印刷物のカラースペースを表すICCプロファイルを選択します。印刷条件に合
    わせて異なるプロファイルが提供されていますので、最も適切なものを選択
    するようにしてください（プロファイルに添付のドキュメントや配布先のWeb
    ページなどに印刷条件の記載があるでしょう）。
    不明な点があれば、印刷業者やプロファイルの提供者などに確認を取りまし
    ょう。

  レンダリングインテント
    カラーマネジメントの解説書などを参照してください。一般的には知覚的ま
    たは相対的な色域を維持のどちらかを選択します（最終的な判断は変換結果
    を見て行ってください）。
    絶対的な色域を維持(2)はPhotoshop CS2以降における絶対的な色域を維持の
    変換結果に近くなります。ICCの規格に沿った通常の変換を行う場合にはこれ
    を選択しないでください。

  黒点の補正を使用
    カラーマネジメントの解説書などを参照してください。特に意図するところ
    がない限り、常にオンにしておけばよいでしょう。

  デバイスリンクプロファイルを使用
    デバイスリンクプロファイルを使用して色分解を行う場合にチェックを入れ
    てください。初心者はこれを使用すべきではありません（常にオフにしてお
    く）。

  黒をスミベタに置き換え
    RGB=0,0,0のピクセルをCMYK=0%,0%,0%,100%に置き換えます。

  スミベタの代わりにリッチブラックを使用
    RGB=0,0,0のピクセルについて、Kを100%に置き換えます（CMYは通常の変換結
    果とおおよそ同じ値になります）。

  CMYK擬似コンポジットを作成
    通常分解結果はグレースケールのレイヤーに出力されますが、チェックを入
    れておくことで色付きのレイヤーに出力することができます。分解後に修正
    ・微調整を行う必要がある場合など、4版を重ね合わせて見る方が都合よいと
    感じるときに使用してください（重ね合わせて見られる、ということ以上の
    メリットはありません）。

■色校正ダイアログ
  モニタ/作業用カラースペース
    お使いのモニタのICCプロファイルを選択してください。モニタのプロファイ
    ルが不明または無い場合には、色校正を実行しても有意な結果を得られない
    ので注意してください。

  分解画像のカラースペース
    色分解を行う際に変換先カラースペースで指定したプロファイルを選択しま
    す。

  モード
    Photoshopの校正設定について解説されている本などを参照してください。画
    面上でのみ確認する場合は通常にしておけばよいでしょう。適切な観察条件
    で印刷物と比較する場合は紙色のシミュレーションを選択した方がよいかも
    しれません。

■書き出しダイアログ
  ファイル形式
    TIFF、JPEG、Photoshop PSDのいずれかを選択します。自動選択にしておく
    と、拡張子を元にファイル形式を決定して書き出しを行います（不明な場合
    はTIFF形式が選択されます）。

  圧縮を使用
    オンにするとTIFFではLZW圧縮が、Photoshop PSDではPackBits圧縮が行われ
    ます。
    JPEGの場合は、オンにすると圧縮率優先の設定で、オフにすると画質優先の
    設定で圧縮処理が行われます（オフでLosslessモードになるわけではありま
    せん）。

  クリッピングパス
    クリッピングパスとして使用するパスを選択します。クリッピングパスが有
    効になっていると、パスの外側がマスクされ、背面のオブジェクトが表示・
    印刷されるようになります。
    いくつかのアプリケーション（例えばScribus）では、ページに画像を配置
    した後でクリッピングパスを再指定することが可能です。

  プロファイルを埋め込み
    ファイルに埋め込むICCプロファイルを選択します。埋め込む必要がなければ、
    なしを選択してください。
    デフォルトCMYKプロファイルと印刷シミュレーションプロファイルは、環境
    設定で指定されているプロファイルを埋め込みます。分解時のプロファイル
    は、色分解の際に使用したプロファイルを埋め込みます。


----- 環境設定との連動
separateプラグインは、ダイアログの初期値を環境設定より取得します。プラグ
インの項目と、環境設定の項目との対応は次の通りです。

ソースカラースペース
  →RGBプロファイル

変換先カラースペース
  →CMYKプロファイル

レンダリングインテント
  →ソフトプルーフ描画方法

モニタ/作業用カラースペース
  →モニタプロファイル

分解画像のカラースペース
  →印刷プロファイル

色校正のモード
  →ディスプレイ描画方法
   （"絶対的〜"が"紙色のシミュレーション"になります）

※プロファイルが環境設定で未指定であれば、従来どおりplatform.hに記載され
たファイルが初期値として使用されます。

ノンインタラクティブで実行する場合、プロファイルのパスは空文字に、レンダ
リングインテントと校正のモードは-1に指定しておくと、環境設定の値を取得す
るようになります。


----- サンプルスクリプト
校正とファイル書き出しの手間を省くQProofとQExportを用意しました。レイヤ
ーを統合→分解→色校正（書き出し）の処理を自動化しています。可視部分のコ
ピーとペーストを利用しますので、元のレイヤーはそのまま残ります。

これらのスクリプトでは、変換先カラースペースやレンダリングインテントの指
定を環境設定より取得します。また、ソースカラースペースは元画像の埋め込み
プロファイルを参照します。環境設定にない項目については、スクリプトのダイ
アログ上で指定してください。

"Real black overprinting〜"のオプションを使用すると、アクティブなレイヤ
ーを使ってスミ乗せ処理を行います。このとき、そのレイヤーのカラーは無視さ
れます（スミ乗せだから当然なのですが）。

qproof.scmとqexport.scmを所定のスクリプトフォルダにコピーしてください。
（場所は環境設定ダイアログで確認できます）


----- TIFFインポートプラグイン
separate_import(.exe)をインストールすることで、separateプラグインで分解
するのと同じような状態でCMYK TIFFファイルを読み込むことができるようにな
ります。

ツールボックスのメニューより、取り込み->CMYK TIFF画像からを選択するとフ
ァイル選択ダイアログが開きます（GIMP 2.6以降ではファイル->画像の生成->
CMYK TIFF画像から）。


----- ビルドする際のヒント
Windows用、Mac OS X用、それ以外（Linuxなど）用のMakefileがありますので、
それを利用してビルドすることができます。また、以下も参考にしてください。

・Windowsでビルドする場合には、MinGW/MSYS環境の利用をおすすめします。

・Mac OS Xでビルドする場合には、gccのコンパイルオプションに"-DMACOSX"を追
  加してください。

・platform.hにプロファイルのパスの初期値が記述されていますので、必要に応
  じて変更してください。また、基本的に修正する必要はないはずですが、
  iccbutton.cにプロファイル選択ダイアログの検索パスを設定する箇所がありま
  す。

・GIMP2.2用にビルドする場合は、Makefile内の"-DENABLE_COLOR_MANAGEMENT"を
  削除するか、あるいは"make CM="というようにマクロCMを空にしてください。
  この場合、いくつかの機能は無効になります。
  注：GIMP2.2サポートはバージョン0.5.3を最後に打ち切られました。0.5.4以
  降のバージョンではGIMP2.2向けにビルドできない可能性があります。

・Separate(normal)とSeparate(to Colour)のダイアログ共用を無効化したい場
  合は、Makefile内の"-DSEPARATE_SEPARETE"を削除してください。これにより、
  "plug-in-separate-separate"プロシージャも使用できなくなります。

・複数のバージョンのGIMPがインストールされている環境でビルドする方は、
  pkg-configコマンドが参照する.pcファイルの場所に注意してください。必要
  に応じて、PKG_CONFIG_PATH環境変数を適切に設定してください。


----- 制作者・協力者
現行制作メンバー
  やまかわ <yamma-ma at users.sourceforge.jp>
  muscovite

  http://cue.yellowmagic.info/softwares/separate-plus/index.html

メッセージカタログ提供
  Alexandre Prokoudine
  Cedric Gemy
  Dust
  Raymond Ostertag
  Zbigniew Malach
  Zdenek Hatas

オリジナル版制作
  Alastair M. Robinson
  Sven Neumann
  Michael Schumacher
  Mat Caughron


----- ライセンス
本パッケージに含まれるプラグイン（のソースコード）およびスクリプトは、
GNU General Public Licenseのバージョン2に基づき利用することができます。

詳細は添付のCOPYING（英語）を参照してください。
